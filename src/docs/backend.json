
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile within the Baseline application.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Unique identifier for the user profile, same as Firebase Auth UID."
        },
        "role": {
            "type": "string",
            "description": "The user's role in the application.",
            "enum": ["client", "coach", "admin", "seller"]
        },
        "age": {
          "type": "number",
          "description": "User's age in years."
        },
        "height": {
          "type": "number",
          "description": "User's height in centimeters."
        },
        "weight": {
          "type": "number",
          "description": "User's weight in kilograms."
        },
        "position": {
          "type": "string",
          "description": "User's basketball playing position (PG, SG, SF, PF, C)."
        },
        "experienceLevel": {
          "type": "string",
          "description": "User's experience level in basketball (e.g., beginner, intermediate, advanced)."
        },
        "photoURL": {
          "type": "string",
          "description": "URL of the user's profile photo stored in Firebase Storage.",
          "format": "uri"
        },
        "xp": {
            "type": "number",
            "description": "Experience points earned by the user."
        },
        "address": {
          "type": "string",
          "description": "The user's primary shipping address."
        }
      },
      "required": [
        "uid", "role"
      ]
    },
    "Connection": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Connection",
        "type": "object",
        "description": "Represents a friendship link between two users.",
        "properties": {
            "status": {
                "type": "string",
                "enum": ["pending", "accepted"]
            },
            "initiator": {
                "type": "string",
                "description": "The UID of the user who initiated the connection."
            }
        },
        "required": ["status", "initiator"]
    },
    "ChatMessage": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "ChatMessage",
        "type": "object",
        "description": "Represents a single message in a private chat.",
        "properties": {
            "text": { "type": "string" },
            "senderId": { "type": "string" },
            "receiverId": { "type": "string" },
            "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": ["text", "senderId", "receiverId", "createdAt"]
    },
    "Workout": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Workout",
      "type": "object",
      "description": "Represents a basketball workout with instructions and details. Can be assigned to users.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the workout."
        },
        "authorId": {
            "type": "string",
            "description": "The UID of the admin or coach who created this workout."
        },
        "title": {
          "type": "string",
          "description": "Title of the workout."
        },
        "difficulty": {
          "type": "string",
          "description": "Difficulty level of the workout (e.g., beginner, intermediate, advanced)."
        },
        "duration": {
          "type": "number",
          "description": "Duration of the workout in minutes."
        },
        "category": {
          "type": "string",
          "description": "Category of the workout (shooting, ball handling, defense, conditioning, vertical jump)."
        },
        "description": {
          "type": "string",
          "description": "A short summary of the workout."
        },
        "steps": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Step-by-step instructions for the workout."
        },
        "videoUrl": {
          "type": "string",
          "description": "URL of the embedded video demonstrating the workout.",
          "format": "uri"
        },
        "imageId": {
          "type": "string",
          "description": "ID for the workout image in placeholder-images.json"
        },
        "photoUrl": {
            "type": "string",
            "format": "uri",
            "description": "URL of the workout's dynamically generated image stored in Firebase Storage."
        }
      },
      "required": [
        "id", "authorId", "title", "description", "steps", "videoUrl", "imageId"
      ]
    },
    "WorkoutProgress": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WorkoutProgress",
      "type": "object",
      "description": "Represents a user's progress for a specific workout.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the workout progress entry."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N WorkoutProgress)"
        },
        "workoutId": {
          "type": "string",
          "description": "Reference to Workout. (Relationship: Workout 1:N WorkoutProgress)"
        },
        "date": {
          "type": "string",
          "description": "Date when the workout was performed.",
          "format": "date-time"
        },
        "timeSpent": {
          "type": "number",
          "description": "Time spent on the workout in minutes."
        },
        "isCompleted": {
          "type": "boolean",
          "description": "Indicates whether the workout was completed."
        }
      },
      "required": [
        "id",
        "userId",
        "workoutId"
      ]
    },
    "Meal": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Meal",
      "type": "object",
      "description": "Represents a meal with ingredients, instructions, and nutritional information. Can be assigned to users.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the meal."
        },
        "authorId": {
            "type": "string",
            "description": "The UID of the admin or coach who created this meal."
        },
        "title": {
          "type": "string",
          "description": "Name of the meal."
        },
        "category": {
          "type": "string",
          "description": "Category of the meal (Breakfast, Lunch, Dinner, Snacks, Pre-game meals, Post-game meals)."
        },
        "ingredients": {
           "type": "array",
          "items": { "type": "string" },
          "description": "List of ingredients for the meal."
        },
        "steps": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Step-by-step instructions for preparing the meal."
        },
        "calories": {
          "type": "number",
          "description": "Total calories in the meal."
        },
        "protein": {
          "type": "number",
          "description": "Amount of protein in the meal (in grams)."
        },
        "carbs": {
          "type": "number",
          "description": "Amount of carbohydrates in the meal (in grams)."
        },
        "fat": {
          "type": "number",
          "description": "Amount of fat in the meal (in grams)."
        },
        "imageId": {
          "type": "string",
          "description": "ID for the meal image in placeholder-images.json"
        }
      },
      "required": [
        "id", "authorId", "title", "ingredients", "steps", "calories", "protein", "carbs", "fat", "imageId"
      ]
    },
    "UserMealPlan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserMealPlan",
      "type": "object",
      "description": "Represents a user's saved meal plan with editable daily schedules.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user meal plan."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N UserMealPlan)"
        },
        "mealId": {
          "type": "string",
          "description": "Reference to Meal. (Relationship: Meal 1:N UserMealPlan)"
        },
        "authorId": {
            "type": "string",
            "description": "The UID of the coach who assigned this meal."
        },
        "day": {
          "type": "string",
          "description": "Day of the week for the meal."
        },
        "mealTime": {
          "type": "string",
          "description": "Time of day for the meal (e.g., Breakfast, Lunch, Dinner)."
        }
      },
      "required": [
        "id",
        "userId",
        "mealId",
        "authorId",
        "day",
        "mealTime"
      ]
    },
    "Location": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Location",
        "type": "object",
        "description": "Represents a user-submitted basketball court location.",
        "properties": {
            "id": {
                "type": "string",
                "description": "Unique identifier for the location."
            },
            "name": {
                "type": "string",
                "description": "The name of the court or location."
            },
            "address": {
                "type": "string",
                "description": "The physical address of the location."
            },
            "photoUrls": {
                "type": "array",
                "items": {
                    "type": "string",
                    "format": "uri"
                },
                "description": "URLs of user-submitted photos of the court."
            },
            "creatorId": {
                "type": "string",
                "description": "The UID of the user who submitted this location."
            }
        },
        "required": ["id", "name", "address", "creatorId"]
    },
    "BallIsLifePost": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "BallIsLifePost",
        "type": "object",
        "description": "Represents a 'Ball is Life' post with a selfie and location.",
        "properties": {
            "id": { "type": "string", "description": "Unique identifier for the post." },
            "creatorId": { "type": "string", "description": "The UID of the user who created the post." },
            "creatorName": { "type": "string", "description": "The display name of the creator." },
            "creatorPhotoUrl": { "type": "string", "description": "The profile photo URL of the creator." },
            "selfieUrl": { "type": "string", "description": "URL of the selfie photo stored in Firebase Storage.", "format": "uri" },
            "location": { "type": "string", "description": "The location where the user is playing." },
            "createdAt": { "type": "string", "description": "Timestamp when the post was created.", "format": "date-time" }
        },
        "required": ["id", "creatorId", "creatorName", "selfieUrl", "location", "createdAt"]
    },
    "Product": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Product",
        "type": "object",
        "description": "Represents a merchandise item available in the store.",
        "properties": {
            "id": { "type": "string" },
            "name": { "type": "string" },
            "description": { "type": "string" },
            "photoUrl": { "type": "string", "format": "uri" },
            "priceXp": { "type": "number" },
            "priceCash": { "type": "number" },
            "discountedPriceXp": { "type": "number" },
            "discountedPriceCash": { "type": "number" },
            "stock": { "type": "number" },
            "creatorId": { "type": "string" }
        },
        "required": ["id", "name", "description", "photoUrl", "priceXp", "priceCash", "stock", "creatorId"]
    },
    "UserOrder": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "UserOrder",
        "type": "object",
        "description": "Represents a user's order for a product.",
        "properties": {
            "id": { "type": "string" },
            "userId": { "type": "string" },
            "productId": { "type": "string" },
            "productName": { "type": "string" },
            "photoUrl": { "type": "string", "format": "uri" },
            "paymentMethod": { "type": "string", "enum": ["xp", "cod"] },
            "amountPaid": { "type": "number" },
            "status": { "type": "string", "enum": ["Pending", "Shipped", "Delivered", "Canceled"] },
            "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": ["userId", "productId", "productName", "paymentMethod", "amountPaid", "status", "createdAt"]
    },
     "ScheduleEvent": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ScheduleEvent",
      "type": "object",
      "description": "Represents a single event in a user's schedule.",
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string", "description": "The UID of the user this event belongs to." },
        "date": { "type": "string", "format": "date-time", "description": "The date of the event." },
        "type": { "type": "string", "enum": ["workout", "rest", "game", "meal", "practice", "reminder"], "description": "The type of event." },
        "title": { "type": "string", "description": "The title of the event." },
        "workoutId": { "type": "string", "description": "Optional reference to a Workout ID if type is 'workout'." },
        "mealId": { "type": "string", "description": "Optional reference to a Meal ID if type is 'meal'." }
      },
      "required": ["userId", "date", "type", "title"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information. Path-based ownership enables simple security rules based on request.auth.uid == userId.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
       {
        "path": "/users/{userId}/connections/{friendId}",
        "definition": {
          "entityName": "Connection",
          "schema": { "$ref": "#/backend/entities/Connection" },
          "description": "Stores a user's connections (friends). Writable by the user and the friend to establish connection.",
          "params": [
            { "name": "userId", "description": "The user's UID." },
            { "name": "friendId", "description": "The friend's UID." }
          ]
        }
      },
      {
        "path": "/users/{userId}/workoutProgress/{workoutProgressId}",
        "definition": {
          "entityName": "WorkoutProgress",
          "schema": {
            "$ref": "#/backend/entities/WorkoutProgress"
          },
          "description": "Stores the workout progress of a user. Path-based ownership enables simple security rules based on request.auth.uid == userId.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "workoutProgressId",
              "description": "The unique identifier of the workout progress entry."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/schedule/{scheduleId}",
        "definition": {
          "entityName": "ScheduleEvent",
          "schema": { "$ref": "#/backend/entities/ScheduleEvent" },
          "description": "Stores a user's schedule events. Writable by the user or their coach.",
          "params": [
            { "name": "userId", "description": "The user's UID." },
            { "name": "scheduleId", "description": "The unique ID of the schedule event." }
          ]
        }
      },
      {
          "path": "/users/{userId}/orders/{orderId}",
          "definition": {
              "entityName": "UserOrder",
              "schema": { "$ref": "#/backend/entities/UserOrder" },
              "description": "Stores a user's individual merchandise orders. Users can only read/write their own orders.",
              "params": [
                  { "name": "userId", "description": "The user's UID." },
                  { "name": "orderId", "description": "The unique ID of the order." }
              ]
          }
      },
      {
        "path": "/mealPlans/{mealPlanId}",
        "definition": {
          "entityName": "UserMealPlan",
          "schema": {
            "$ref": "#/backend/entities/UserMealPlan"
          },
          "description": "Stores the meal plans of a user, assigned by a coach.",
          "params": [
            {
              "name": "mealPlanId",
              "description": "The unique identifier of the meal plan."
            }
          ]
        }
      },
       {
        "path": "/chats/{chatId}/messages/{messageId}",
        "definition": {
          "entityName": "ChatMessage",
          "schema": { "$ref": "#/backend/entities/ChatMessage" },
          "description": "Stores messages for a private chat between two users.",
          "params": [
            { "name": "chatId", "description": "A composite key of the two user UIDs, sorted alphabetically and joined by an underscore." },
            { "name": "messageId", "description": "The unique ID of the message." }
          ]
        }
      },
      {
        "path": "/workouts/{workoutId}",
        "definition": {
          "entityName": "Workout",
          "schema": {
            "$ref": "#/backend/entities/Workout"
          },
          "description": "Stores a central library of workout information. This collection should be readable by all users but only writable by admins.",
          "params": [
            {
              "name": "workoutId",
              "description": "The unique identifier of the workout."
            }
          ]
        }
      },
      {
        "path": "/meals/{mealId}",
        "definition": {
          "entityName": "Meal",
          "schema": {
            "$ref": "#/backend/entities/Meal"
          },
          "description": "Stores a central library of meal information. This collection should be readable by all users but only writable by admins.",
          "params": [
            {
              "name": "mealId",
              "description": "The unique identifier of the meal."
            }
          ]
        }
      },
      {
        "path": "/locations/{locationId}",
        "definition": {
            "entityName": "Location",
            "schema": {
                "$ref": "#/backend/entities/Location"
            },
            "description": "Stores user-submitted court locations. Readable by all, writable by authenticated users.",
            "params": [
                {
                    "name": "locationId",
                    "description": "The unique identifier of the location."
                }
            ]
        }
      },
      {
        "path": "/ballIsLife/{postId}",
        "definition": {
            "entityName": "BallIsLifePost",
            "schema": {
                "$ref": "#/backend/entities/BallIsLifePost"
            },
            "description": "Stores user-generated 'Ball is Life' posts. Readable by all, writable by the authenticated post creator.",
            "params": [
                {
                    "name": "postId",
                    "description": "The unique identifier of the post."
                }
            ]
        }
      },
      {
        "path": "/products/{productId}",
        "definition": {
            "entityName": "Product",
            "schema": { "$ref": "#/backend/entities/Product" },
            "description": "Stores all merchandise products. Readable by all, writable only by admins and sellers.",
            "params": [{ "name": "productId", "description": "The unique identifier of the product." }]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to prioritize authorization independence, clarity, and scalability. User-owned data (workout progress, schedule, orders) is stored in subcollections under the `/users/{userId}` path to easily control data access. A central, public library for workouts, meals, locations, and products is maintained in top-level collections. This segregation simplifies security rules: user-specific data is protected by ownership checks, while public content is broadly readable but write-protected, awaiting a proper admin/seller role for content management."
  }
}

    